/** Function to clean sheets and/or recreate tabs */
function createInputSheets() {
    activeSpreadsheet = SpreadsheetApp.getActiveSpreadsheet();
    if (activeSpreadsheet.getSheetByName('accounts') == null) {
        getAccountDataSheet = activeSpreadsheet.insertSheet();
        getAccountDataSheet.setName('accounts').setTabColor("#4F5165");
    }
    if (activeSpreadsheet.getSheetByName('properties') == null) {
        getAccountDataSheet = activeSpreadsheet.insertSheet();
        getAccountDataSheet.setName('properties').setTabColor("#547AA5");
    }
    if (activeSpreadsheet.getSheetByName('streams') == null) {
        getAccountDataSheet = activeSpreadsheet.insertSheet();
        getAccountDataSheet.setName('streams').setTabColor("#50D8D7");
    } else {
        activeSpreadsheet.getSheetByName('accounts').clearContents();
        activeSpreadsheet.getSheetByName('properties').clearContents();
        activeSpreadsheet.getSheetByName('streams').clearContents();
    }
};

/** Function to clean everything, recreate tabs and pull accounts, properties and streams */
function startFromScratch() {
    activeSpreadsheet = SpreadsheetApp.getActiveSpreadsheet();
    if (activeSpreadsheet.getSheetByName('accounts') == null) {
        getAccountDataSheet = activeSpreadsheet.insertSheet();
        getAccountDataSheet.setName('accounts').setTabColor("#4F5165");
    }
    if (activeSpreadsheet.getSheetByName('properties') == null) {
        getAccountDataSheet = activeSpreadsheet.insertSheet();
        getAccountDataSheet.setName('properties').setTabColor("#547AA5");
    }
    if (activeSpreadsheet.getSheetByName('streams') == null) {
        getAccountDataSheet = activeSpreadsheet.insertSheet();
        getAccountDataSheet.setName('streams').setTabColor("#50D8D7");
    } else {
        activeSpreadsheet.getSheetByName('accounts').clearContents();
        activeSpreadsheet.getSheetByName('properties').clearContents();
        activeSpreadsheet.getSheetByName('streams').clearContents();

        SpreadsheetApp.getActiveSpreadsheet().toast('âš™ï¸ Getting a lot of data. Time to go for a walk ğŸš¶â€â™€ï¸ğŸš¶â˜•', 'Please wait', 15)
        listAccounts();
        listWebProperties();
        listStreams();
    }
};

/** Create menu */
function onOpen() {
    var ui = SpreadsheetApp.getUi();
    ui.createMenu('âš™ï¸ Get Started âš™ï¸')
        .addItem('0. Clean or recreate tabs ğŸ”„', 'createInputSheets')
        .addItem('1. Get Accounts ğŸ‘ª', 'listAccounts')
        .addItem('2. Get GA4 Properties ğŸ˜', 'listWebProperties')
        .addItem('3. Get GA4 Streams âš¡', 'listStreams')
        .addItem('4. Get everything from scratch âš¡âš¡âš¡', 'startFromScratch')
        .addToUi();
};
